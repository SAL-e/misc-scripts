#!/bin/bash

if [ "$DOWNLOADS" = "" ]
then
  download_dir=~/Downloads
else
  download_dir=$DOWNLOADS
fi
#echo $download_dir

download_npp () {
  cd $download_dir
  download_url="https://notepad-plus-plus.org/repository/$1/$2/"
  checksum_file="npp.$2.checksums.sha256"
  exe_file="npp.$2.Installer.x64.exe"
  rm $checksum_file
  wget "$download_url$checksum_file"
  if [ -f $checksum_file ]
  then
    cat $checksum_file | tr -d '\r' | sha256sum --ignore-missing -c
    if  [ "$?" -ne 0 ]
    then
      rm $exe_file
      wget "$download_url$exe_file"
      cat $checksum_file | tr -d '\r' | sha256sum --ignore-missing -c
      if  [ "$?" -ne 0 ]
      then
        echo "FAIL"
        rm $exe_file
      fi
    fi
  fi
  cd -
}

download_npp 7.x 7.7.1

#https://notepad-plus-plus.org/repository/7.x/7.6.6/npp.7.6.6.checksums.sha256
#https://notepad-plus-plus.org/repository/7.x/7.6.6/npp.7.6.6.Installer.x64.exe
